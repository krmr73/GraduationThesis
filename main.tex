%%
% このファイルは筑波大学情報学群情報科学類の卒業研究論文のサンプルです。
% このファイルを書き換えて、このサンプルと同様の書式の論文をLaTeXを使って
% 作成できます。
%
% OSやLaTeXの設定によっては漢字コードや改行コードを変更する必要があります。
%%
% \documentclass[a4paper,11pt]{jreport}

%%【PDF, PostScript, JPEG, PNG等の画像の貼り込み】
%% dvipdfmx を使う場合
\documentclass[uplatex,11pt,openany]{ujreport}

\usepackage[table]{xcolor}
\usepackage[dvipdfmx]{graphicx}

%% dvipdfmx を使ってPDFの「しおり」を付ける場合
%%\usepackage[dvipdfmx,bookmarks=true,bookmarksnumbered=true,bookmarkstype=toc]{hyperref} \usepackage{pxjahyper}

\usepackage{ulem}
\usepackage{times} % use Times font instead of default one
\usepackage[super]{cite}
\usepackage{subcaption}

\usepackage{url}
\usepackage{caption}
\usepackage{booktabs}
\usepackage{amssymb}
\usepackage{lscape}
\usepackage{here}

\setcounter{tocdepth}{3}
\setcounter{page}{-1}
\renewcommand{\thesubtable}{\Alph{subtable}}

\setlength{\oddsidemargin}{0.1in}
\setlength{\evensidemargin}{0.1in}
\setlength{\topmargin}{0in}
\setlength{\textwidth}{6in}
%\setlength{\textheight}{10.1in}
\setlength{\parskip}{0em}
\setlength{\topsep}{0em}

%% タイトル生成用パッケージ（重要）
\usepackage{coins-jp}

%% タイトル
\title{ソーシャルネットワークにおける多様な相互作用を\\捉えるエージェントベースモデル}
%% 著者
\author{岩橋七海}
%% 指導教員　
\advisor{岡瑞起}

%% 年度と主専攻名
\fiscalyear{2024}
%\majorfield{ソフトウェアサイエンス主専攻}
% \majorfield{情報システム主専攻}
\majorfield{知能情報メディア主専攻}

\renewcommand{\bibname}{参考文献}

\begin{document}
\maketitle
\thispagestyle{empty}
\newpage

\thispagestyle{empty}
\vspace*{20pt plus 1fil}
\parindent=1zw
\noindent
%%
%% 論文の要旨
%%
\begin{center}
{\Large \bf 要　　旨}
\vspace{2cm}
\end{center}
この文書は筑波大学情報学群情報科学類の卒業研究論文のサンプルである。
このファイルを書き換えて、このサンプルと同様の書式の論文を \LaTeX を
使って作成できる。

このサンプルは、学生が論文を作成する手間を軽減するために提供している。
このサンプルで示す書式はあくまで例であり、要項に準拠していれば、この
ファイルを使わずに自分で決めた書式を用いてもよい。

%%%%%
\par
\vspace{0pt plus 1fil}
\newpage

\pagenumbering{roman} % I, II, III, IV
\tableofcontents
\listoffigures
%\listoftables

\pagebreak \setcounter{page}{1}
\pagenumbering{arabic} % 1,2,3

\chapter{序論}
    \section{背景}
    人間の社会は何気ない挨拶、取引や交渉、SNSでのコミュニケーションなどの様々な相互作用によって成り立っている。
    インターネットとモバイルデバイスの登場は、こうした多面的な相互作用に関するデータの記録と収集を容易にした。
    その中で、ソーシャルネットワークプラットフォームやオンラインソーシャルゲームを用いることで、人間の相互作用のモデリングや根的にあるパターンや原理の発見が可能になる。
    これらのコミュニケーションを包括的に理解することは、新規ユーザーを獲得し、既存のユーザーを維持するための効果的なサービスの開発に貢献すると考えられる。

    これまで人間の活動を再現し理解するために、数理モデルが用いられてきた。
    ネットワークは新たなノードやエッジの追加といった成長と、ネットワークの構造やエッジの重みといったダイナミクスの二つの側面から考えることができる。
    ネットワークの成長のモデルとしては、Barabasi--Albert(BA)モデルのような優先的選択性を捉え、スケールフリー性を表せるモデルがある\cite{barabasi_emergence_1999,barabasi_origin_2005,barabasi_scale-free_2009}。
    BAモデルはネットワークの成長を表すことはできるが、ネットワークの完全なダイナミクスを表現することはできない。
    ネットワークのダイナミクスに焦点を当てたモデルは、現実世界のネットワーク構造をよりよく模倣するために、様々な手法を提案している。
    これらの方法には、1つのステップで複数のエッジを導入する方法\cite{albert_topology_2000}、友人が繋がりを作る可能性が高いtriadic closure\cite{bianconi_triadic_2014}、ユーザーの職業や信頼性に基づくフィットネスなどのノードの特性を考慮する方法\cite{topirceanu_weighted_2018}などがある。
    しかし、これらのモデルは、既存のノード間の関係を強化したり、新しい接続を形成したりするような活動をとらえることができず、複雑なネットワークの複雑さを完全に表現することはできない。

    これらのモデルの原理を活用し、実際のデータを再現する精度を向上させるために、様々なモデルが提案されている。
    モデルの一つのカテゴリーは、新規性の出現は従来想定されていたようなランダムなものではなく、「隣接可能空間」から発生するという考え方を取り入れたものである\cite{monechi_waves_2017,suda_exploration_2022,ubaldi_emergence_2021}。
    隣接可能空間とは現在の観測範囲から1ステップ外の空間のことであり、何らかのきっかけが一つあれば観測できる要素によって張られている。
    Kaufmanは当初、分子や生物の進化を解明するためにこの考えを提唱した\cite{kauffman_origins_1993}。
    同様の考え方はタンパク質空間説にも見られ、遺伝子の進化は既存の遺伝子の微小な変化の積み重ねによって起こるものとし、その変化は遺伝子が表現型を形成できる制約の下で起こらなければならないと主張した\cite{maynard_smith_natural_1970}。
    Kaufmanはこの理論を遺伝子の進化だけでなく、人間関係の進化や技術革新の発展など様々な分野に拡張し、一般化した。

    このような隣接可能空間の考え方は、Triaら\cite{tria_dynamics_2014}によってモデル化された。
    このモデルはトリガー付き壺モデルと呼ばれ、環境に壺が一つ存在すると仮定し、壺からエージェントを表す玉を選択したり追加したりすることでシステムの動作を表す。
    Ubaldiらは、各エージェントにそれぞれの壺を割り当てることで、このモデルをエージェントベースのモデルに拡張した\cite{ubaldi_emergence_2021}。
    このモデルでは、隣接可能空間を通じて、エージェント同士のつながりを作ることで、社会的ネットワークが拡大すると仮定されている。
    エージェント個々の定義されたルールセットに従って、社会的相互作用のダイナミクスをカプセル化し、エージェントの行動を決定する。
    これらのルールは、ネットワークの成長とダイナミクスを捉え、既に相互作用したことがある人との相互作用、新しい人との相互作用、新しい人と関わるための隣接可能空間の探索を含む。
    比較的単純にもかかわらず、このモデルはTwitter上で行われる返信や論文の共著、携帯電話の発信などの振る舞いを性格に表現できることが報告されている\cite{ubaldi_emergence_2021}。

    しかし、隣接可能空間を探索するという考え方をモデルに組み込むことには課題もある。
    従来のモデルでは、人間がこの空間を探索する戦略をあらかじめ定義しておく必要がある。
    そのため、実際のデータに最も適合するパラメータの最適化探索は、これらの事前に定義した戦略に制約される\cite{suda_exploration_2022,suda_agent-based_2022,ubaldi_emergence_2021}。
    この制限に対応するため、本研究では複数の戦略に対応し、これらを効率的に探索できるモデルを提案する。
    戦略をベクトル表現することで柔軟な探索を可能にし、進化的アルゴリズムのQuality Diversityアルゴリズムを用いることで効率的な探索を行う。
    提案するモデルによって、実世界のソーシャルネットワークの相互作用を正確に捉えることを目的とする。
    提案モデルは、既存手法と比較して実データとの整合性において優れた性能を示した。
    相互作用を行う際に多くの戦略を取るという結果から、効率的な戦略の多様性が示され、社会ネットワークの理解につながると考えられる。
    将来的には、より正確な予測モデルの設計からソーシャルメディア戦略の開発への情報提供まで、幅広い応用が期待される。



% BAモデルは成長するネットワークにおける優先的選択制を捉え、スケールフリーなネットワークの出現を説明できる。
% また、ネットワークのダイナミクスのモデルとしては、triadic closureを導入したモデルがあるが、既存のノード間の複数回の相互作用や既存のノード間の新しいエッジの追加などダイナミクスを考慮しきれていない。
% ポリアの壺モデルをベースとし、ネットワークの成長とダイナミクスの両方を考慮したエージェントベースモデルが提案されており、本研究はこのモデルをベースとしている。
% このモデルは様々な実データの振る舞いをより正確に表現できることが報告されている。


\chapter{関連研究}
    \section{エージェントベースのポリアの壺モデル}
    Ubaldiらのモデルは、社会的相互作用の複雑なダイナミクスを捉えるために、ポリアの壺モデルをベースとしている\cite{ubaldi_emergence_2021}。
    このモデルは社会的相互作用における個人を「エージェント」、個人がそれぞれ持つ情報空間を「壺」として表現する。
    この壺には今後相互作用を行う可能性のあるエージェント、すでに相互作用したエージェントを示す「玉」が入っている。
    このモデルは次の3ステップで相互作用を行う。
        \begin{description}
            \item[ステップ1] 発信側エージェントを選択する
            \item[ステップ2] 着信側エージェントを選択する
            \item[ステップ3] 発信側・着信側エージェント間で相互作用する
        \end{description}
    この3つのステップにより、相互作用のネットワークが生成される。
    これらのステップについて、以下に詳しく説明する。

        \subsection*{ステップ1: 発信側エージェントを選択する}
        このステップでは、環境全体から発信側エージェントを一人選択する。
        壺に入っている玉の数を重みとして、ランダムにエージェントを選択する。
        そのため、壺が大きいほど、そのエージェントが選択される確率が高くなる。
        これは、優先的選択制を表現しており、コネクションの数が多いエージェントほど、新しいコネクションを構築する可能性が高くなることを表している。

        \subsection*{ステップ2: 着信側エージェントを選択する}
        発信側エージェントが持っている壺の中から、ランダムに着信側エージェントを選択する。

        \subsection*{ステップ3: 発信側・着信側エージェント間で相互作用する}
        発信側と着信側の相互作用によって、それぞれの壺の状態が変化する。
        過去に相互作用しているエージェントとの相互作用のしやすさを表す$\rho$、新しいエージェントとの相互作用のしやすさを表す$\nu$および紹介するエージェントの選び方を表す戦略$s$の3つのパラメータが用いられる。
        Ubaldiのモデルの戦略には、(WSW)、Symmetric Sliding Window (SSW)、Asymmetric Sliding Window (ASW)などの6種類がある。
        3つのステップを踏んで相互作用の繰り返すことにより、ネットワークが成長する。
        その相互作用は図\ref{fig:model_ubaldi}の3つの状態のいずれかになり、それぞれ以下のように進行する。

        \begin{figure}[htbp]
            \centering
            \includegraphics[width=\textwidth]{img/model_ubaldi.png}
            \caption{相互作用の3つの状態}
            \label{fig:model_ubaldi}
        \end{figure}


            \subsubsection*{相互作用していない相手との相互作用(A)}
            発信側エージェントaと着信側エージェントbが初めて相互作用する場合、両方のエージェントの壺にそれぞれ相手の玉を$\rho$個追加する。
            この強化ステップによって、既に相互作用した人と再度相互作用する確率が高くなる。
            初めての相互作用の場合のみ、両方のエージェントが持っている玉を$\nu+1$個ずつ交換する。
            この紹介ステップによって、両方のエージェントの隣接可能空間が広がり、過去に相互作用していない新しい人と相互作用する可能性ができる。
            この交換方法は戦略$s$によって決められる。

            \subsubsection*{既に相互作用した相手との相互作用(B)}
            発信側エージェントaと着信側エージェントbが再度相互作用する場合も両方のエージェントの壺にそれぞれ相手の玉を$\rho$個追加する。
            初めて相互作用する相手でない場合は、互いの壺の中から交換する紹介ステップは行わないため、隣接可能空間は変化しない。

            \subsubsection*{新しいエージェントの追加(C)}
            どのエージェントとも繋がっていないエージェントが着信側として選ばれた場合、$\nu+1$個のエージェントを新しく壺に追加する。
            その後は相互作用していない相手との相互作用(A)の場合と同様に進行する。
            この場合は新しいエージェントが生成されるため、隣接可能空間をさらに広げることになる。







    \section{進化的アルゴリズム}
    進化的アルゴリズムは、生物の進化から着想を得た確率的探索手法である。
    問題に対して変化と選択に基づく世代交代を繰り返すことで、解の集団を進化させ最適解を得る。


        \subsection{遺伝的アルゴリズム}
        遺伝的アルゴリズムは、進化的アルゴリズムの中で最も一般的なアルゴリズムである。
        進化をモデルとした確率的探索手法の一つであり、問題の解を個体とする。
        個体ごとに遺伝子情報を与え、選択、交叉、突然変異といった操作を行うことで、個体の集団を進化させる。
        以下の流れで探索が行われる。
            \begin{enumerate}
                \item 初期集団を生成する
                \item 適応度を評価する
                \item 集団の中から親を選択する
                \item 親の遺伝子を交叉させる
                \item 子の遺伝子に突然変異を加える
                \item 2$\sim$5を繰り返す
            \end{enumerate}


        \subsection{Quality Diversityアルゴリズム}
        Quality Diversity(QD)アルゴリズムは、多様で高性能な解を探索するように設計されたアルゴリズムである\cite{pugh_quality_2016}。
        このアルゴリズムでは、個体の振る舞いを特徴づけるベクトルBehavioral Descriptor(BD)を利用して、領域内の会に対する個体の新規性を定量化する。
        各領域はその領域に対して、可能な限り適合したエージェントになるように反復的に決定される。
        QDには二つの代表的なアルゴリズムがある。
        その一つはNovelty Search with Local Competition(NSLC)\cite{lehman_evolving_2011}である。
        このアルゴリムはNovelty Searchに局所的な競争の概念を導入している。
        個体をマッピングする領域は、BD空間におけるユークリッド距離に基づき、非構造化アーカイブを用いて決定する。

        二つ目の代表的なアルゴリズムにMuliti-dimensional Archive of Phenotypic Elites(MAP-Elites)\cite{mouret_illuminating_2015}がある。
        このアルゴリズムでは、BD空間はいくつかのグリッドに分けられる。
        各グリッドにはマッピングされた単一の最も適合したエージェントが記憶される。
        そして、BD空間を埋めるように探索を進める。エージェントはグリッドから選択され、突然変異などのランダムな変化を受ける。
        そうしてできた新しい個体はその行動に対応するグリッドにマッピングされ、適合度が現在の占有者より高ければ記録される。

        MAP-Elitesはセル数が特徴空間の次元数に応じて、指数関数的に増加するため、高次元のBD空間に対応するのは難しい。
        また、セル数が増えることによって、選択圧が低くなってしまうことも問題である。
        この問題を解決するために、MAP-Elitesを高次元の特徴空間にスケールアップするCVT-Map Elites\cite{vassiliades_using_2017}が提案されている。
        このアルゴリズムは、BD空間をグリッド上ではなく、重心ボロノイ分割によってボロノイ状のセルに分割する.
        この方法の場合、セル数を固定してBD空間の次元を拡張することが可能になるため、高次元のBD空間の探索において、MAP-Elitesよりも優れた性能を示す.






\chapter{手法}
    従来のモデルでは、人間がこの空間を探索する戦略をあらかじめ定義しておく必要がある。
    そのため、実際のデータに最も適合するパラメータの最適化探索は、これらの事前に定義した戦略に制約される\cite{suda_exploration_2022,suda_agent-based_2022,ubaldi_emergence_2021}。
    この制限に対応するため、本研究では複数の戦略に対応し、これらを効率的に探索できるモデルを提案する。
    戦略をベクトル表現することで柔軟な探索を可能にし、進化的アルゴリズムのQuality Diversityアルゴリズムを用いることで効率的な探索を行う。
    提案するモデルによって、実世界のソーシャルネットワークの相互作用を正確に捉えることを目的とする。

    既存のモデルでは、この問題を解決するために2つのことを行っている。
    (1)戦略をベクトル表現することで、柔軟な探索を可能にし、探索空間を拡張する。
    (2)Quality Diversityアルゴリズムを用いることで、拡張された探索空間に適した効率的な探索を行う。

    \section{戦略のベクトル表現}
        Ubaldiらによって提案された既存モデルでは、戦略sは事前に定義された方法に制限されていた。
        これらの戦略は実世界の相互作用の一部を捉えることができていますが、実際の相互作用に用いられる多様な戦略を全て表現することはできない。
        例えば、頻繁に相互作用するが、最近相互作用していないエージェントを優先する戦略は、実世界のネットワークを正確に表現するかもしれません。
        こにょうに広い戦略を捉えるために、戦略を遺伝子を示すベクトルとして表現する。
        具体的には、戦略は最近度(recency:r)、頻度(frequency:f)という二つの遺伝子として構成されるベクトルとして表され、それぞれの遺伝子は-1から1の範囲内で値を取る。
        例えば、最近度が-0.5で頻度が0.5の戦略ベクトルは、最近度が低いが相互作用頻度が高いエージェントを優先する。
        図\ref{fig:strategy}に戦略ベクトルを使った相互作用の例を示す。
        図\ref{fig:strategy}-(A)は最近度が高いが頻度が低い相互作用を優先する戦略の場合を表しており、図\ref{fig:strategy}-(B)は最近度が低いが頻度が高い相互作用を優先する戦略の場合を表している。
        連続値で表現することで、探索空間のより包括的で柔軟な探索が可能になる。

        \begin{figure}[htbp]
            \centering
            \includegraphics[width=\textwidth]{img/model_proposed.png}
            \caption{戦略ベクトルを使った相互作用の例}
            \label{fig:strategy}
        \end{figure}

    \section{進化的アルゴリズムによる探索}
        Ubaldiらのモデルは、あらかじめ決められた範囲内でパラメータ$\rho,\nu,s$の組み合わせの全探索を行なっている。
        最適なパラメータは、ネットワークの特徴を表す10個の指標を用いて評価される。
        モデルで生成したネットワークと実データのネットワークの指標の差を最小化するものを最適なパラメータとしている。

        しかし、提案モデルでは戦略は連続値のベクトルとして表現されるため、潜在的な戦略の数が大幅に増加し、全探索するのは現実的ではない。
        この問題を解決するために、一つのパラメータセットを$\rho,\nu$と戦略を表す最近度$r$,頻度$f$で構成される4次元ベクトルとして表し、進化的アルゴリズムを用いて実データに最も近いパラメータセットを効率的に探索する。

        具達的には、遺伝的アルゴリズム(GA)とQuality Diversity(QD)アルゴリズムを用いる。
        遺伝的アルゴリズムでは、データとの距離$d$の逆数を適応度とし、選択にはルーレット選択を用いている。
        QDアルゴリズムとしては、高次元のBD空間に対してMAP-Elitesより高い性能を示すCVT-MAP-Elitesを用いる。
        提案モデルによって作成されたネットワークをBD空間にマッピングするために、graph2vecを用いて、ネットワークのグラフを128次元のベクトルに変換する。
        このベクトルをBDとして用いる。


    \section{評価指標}
        モデルの目標データへの適応度を次式で計算される距離$d$を用いて評価する。
        \begin{equation}
            d = \sum^{p\in P}|P_{model}-P_{target}|
        \end{equation}
        ここで、$P={\gamma,C,Y,R, \langle h\rangle ,G,OC,OO,NC,NO}$は、ネットワークの成長とダイナミクスを表現する10個の指標の集合である。
        モデルによって作成した全てのデータの中の距離$d$が最小のものが最適なパラメータとなる。

        モデルの評価は、Ubaldiらが提案したモデルの生成するネットワークのトポロジーとそのダイナミクスに関する6つの指標\cite{ubaldi_emergence_2021}と、Monechiらが提案した4つの新規性に関する指標\cite{monechi_waves_2017}を用いて行う。
        Ubaldiらが提案している8つの指標の中で、詳細な記述と再現性が不足している指標を除いた6つの指標を用いている。

        評価に用いた指標は以下の通りである。
        \begin{itemize}
            \item Heaps則の指数$\gamma$\\成長するネットワークで新しい要素が発見されるペースを定量化する
            \item クラスター係数$C$\\ネットワークのクラスター性を表す
            \item 若さ係数$Y$\\相互作用の新しさを表す
            \item 最近度$R$\\相互作用の時間的な近さを表す
            \item 局所エントロピー$\langle h\rangle$\\相互作用するエージェントの多様性を示す
            \item 擬似ジニ係数$G$\\エージェントの注目度の格差を表す
            \item 4つの相互作用の新規性と閉鎖性の指標\\\verb|old-closed|($OC$)、\verb|old-open|($OO$)、\verb|new-closed|($NC$)、\verb|new-open|($NO$)
        \end{itemize}

        相互作用の新規性は、相互作用が以前に発生しているかどうかによって定義され、\verb|old|は複数回目の相互作用、\verb|new|は初めての相互作用を示す。
        閉鎖性の概念は相互作用するエージェント同士が、隣接可能空間の中で共通のエージェントがいるかどうかに関連している。
        \verb|closed|は共通のエージェントがいる場合、\verb|open|は共通のエージェントがいない場合を示す。
        これらの指標をネットワークダイナミクス、構造、および新規性を定量的に評価するために用いる。


\chapter{実験}
    本研究では3つのResearch Question(RQ)を設定しており、そのRQに対応する実験を行なった。
    以下にRQと実験の概要を示す。
        \subsubsection*{RQ1:提案手法はUbaldiらのモデルと比較して、モデルによって作成した合成データに対してどのような性能を示すか}
            RQ1に答えるためにランダムサーチ、遺伝的アルゴリズム、Quality Diversityアルゴリズムを用いた提案手法と全探索を用いる既存手法の4つの手法を比較した。
            ランダムサーチは、遺伝的アルゴリズムがランダムサーチよりも優れた利点を持つか確かめるために用いている。
        \subsubsection*{RQ2:提案手法はUbaldiらのモデルと比較して、実世界のデータの振る舞いをどの程度正確に再現できるか}
            RQ2に答えるために、提案手法と既存手法を実世界のデータに適用し、その結果を比較した。
            モデルによって生成した相互作用と3つの実データの相互作用との一致度を評価することによって、提案手法の有効性を評価した。
            RQ1に対する実験と同様に、4つの手法を比較した。
        \subsubsection*{RQ3:実世界のデータにおける隣接可能空間の探索では、どのような戦略が用いられているか}
            RQ3に答えるために、実データに対して、提案手法が見つけたパラメータから、隣接可能空間の探索に用いられている戦略を分析した。

    \section{データセット}
        本研究の実験には、モデルによって作成した合成データと実世界の振る舞いを示す3つの実データを用いた。
        \subsection{合成データ}
            Ubaldiのモデルを用いて生成された合成データは、

            Ubaldiのモデルでパラメータ$(\rho,\nu)\in {(5,5),(5,15),(20,7)}$、および$s\in{SSW,WSW}$を設定した。
            ここで、SSWはSymmetric Sliding Window戦略を表し、壺の中に最も最近追加されたエージェントを優先する。
            一方、WSWはWeighted Sampling with Withdrawal戦略を表し、壺の中からランダムにエージェントを選択する。
            そのため、確率的に頻度が高いエージェントが選択されやすい。
            これらのパラメータ$\rho,\nu,s$を組み合わせた合計6($=3\times2$)つのパラメータセットを用いて、それぞれ20000ステップの相互作用を行い、生成されたネットワークを合成データとする。
            この合成データをUbaldiらの全探索と提案手法のフレームワークのランダムサーチ、遺伝的アルゴリズムおよびQuality Diversityアルゴリズムとの比較するための目標データとして用いた。

        \subsection{実データ}
            実データとしては、X mention Network(TMN)、American Physical Society(APS)共著ネットワークおよびMIXI Social Game Network(MIXI)の3つのデータセットを用いた。
            TMNとAPSのデータセットは、Ubaldiらの研究\cite{ubaldi_emergence_2021}で使用され、公開されている。
            TMNとAPSデータセットの両方から、20000のcaller-callee相互作用データを評価に使用する。
            MIXIデータセットは、日本の主要なゲーム会社である株式会社MIXIによって、提供していただいたオンラインソーシャルゲーム「モンスターストライク」のデータを用いている。
            MIXIデータセットから49,346,896のcaller-callee相互作用データを評価に使用する。

    \section{パラメータ}
        合成データと実データの両方において、最適なパラメータの探索を行った。
        各手法に対して、指定した範囲内のアルゴリズムのハイパーパラメータとパラメータ($\rho,\nu,s$)および($\rho,\nu,r,f$)を探索した。

        既存モデルでは、$1\leq \rho,\nu\leq20$および$s\in\{\verb|SSW|,\verb|WSW|\}$の800組のパラメータを全探索している。
        それぞれのパラメータセットで20,000ステップの相互作用を実行している。
        目標データとの距離$d$を最小に抑えたパラメータセット、すなわち目標データに最も近いネットワークを生成したパラメータセットを探索する。

        提案モデルでは、$1\leq \rho,\nu \leq30$および$-1.0\leq r,f\leq 1.0$の範囲で、ランダムサーチ、遺伝的アルゴリズムおよびQDアルゴリズムによりパラメータを探索する。
        ランダム探索では、合成データに対して100回、実データに対して500回の探索を行う。
        遺伝的アルゴリズム、QDアルゴリズムでは、合成データに対して100世代、実データに対して500世代に固定して探索を行う。
        遺伝的アルゴリズムでは、交叉率、突然変異率、個体数のハイパーパラメータをグリッドサーチにより最適化する。
        ハイパーパラメータは、交叉率$C\in\{0.80,0.85,0.90.0.95\}$、突然変異率$M\in\{0.01,0.02,0.03,0.04,0.05\}$、個体数$N\in\{10,20,30,40,50\}$の組み合わせの中から最適なものを選択した。

        QDアルゴリズムでは、Pythonライブラリのpyribs\cite{vassiliades_pyribs_2021}を用いる。
        生成されたネットワークのグラフは、graph2vecアルゴリズムを用いて、ベクトルに変換する。
        CVT-MAP-Elitesのセル数とグラフを変換したベクトルの次元数をグリッドサーチにより最適化する。
        セル数は$250,500,750$、ベクトルの次元数は$64,128,256$の組み合わせの中から最適なものを選択した。
        変異率はCVT-MAP-Elitesでは初期値が設定されるが、CMA-ESアルゴリズム\cite{}によって決められ、一定ではないため、ハイパーパラメータチューニングを行っていない。
        グリッドサーチによって、見つけた最適なハイパーパラメータを表\ref{tab:hyperparameter}に示す。
        このパラメータを用いて、提案手法の探索を行った。

        \begin{table}[htbp]
            \caption{最適なハイパーパラメータ}
            \label{tab:hyperparameter}
            \centering

            \begin{subtable}[h]{\textwidth}
                \centering
                \caption{合成データ}
                \begin{tabular}{c|ccc|cc}
                    \hline
                                            & \multicolumn{3}{c|}{GA} & \multicolumn{2}{c}{QD} \\
                                            & 交叉率    & 突然変異率  & 個体数  & セル数      & BDの次元数      \\  \hline
                    ($\rho=5,\nu=5,s=$SSW)  & 0.8    & 0.01   & 30   & 500      & 128         \\
                    ($\rho=5,\nu=5,s=$WSW)  & 0.8    & 0.02   & 30   & 250      & 256         \\
                    ($\rho=5,\nu=15,s=$SSW) & 0.95   & 0.03   & 20   & 500      & 128         \\
                    ($\rho=5,\nu=15,s=$WSW) & 0.8    & 0.01   & 10   & 250      & 128         \\
                    ($\rho=20,\nu=7,s=$SSW) & 0.8    & 0.04   & 50   & 750      & 64          \\
                    ($\rho=20,\nu=7,s=$WSW) & 0.8    & 0.01   & 10   & 250      & 128         \\ \hline
                \end{tabular}
            \end{subtable}

            \vspace{1zh}

            \begin{subtable}[h]{\textwidth}
                \centering
                \caption{実データ}
                \begin{tabular}{c|ccc|cc}
                    \hline
                        & \multicolumn{3}{c|}{GA} & \multicolumn{2}{c}{QD} \\
                        & 交叉率   & 突然変異率   & 個体数   & セル数      & BDの次元数      \\ \hline
                    TMN  & 0.85   & 0.05    & 20    & 250      & 64         \\
                    APS  & 0.85   & 0.01    & 40    & 250      & 256         \\
                    MIXI & 0.85   & 0.04    & 30    & 250      & 128         \\ \hline
                \end{tabular}
            \end{subtable}

        \end{table}



    \section{実験結果と考察}
        \subsection{RQ1:合成データによる精度比較}
            6つの合成データのそれぞれに対して、既存モデルの全探索、提案モデルのランダムサーチ、遺伝的アルゴリズム、QDアルゴリズムを用いて、最適なパラメータを探索した。
            この実験では、既知の正しいパラメータセットを用いた合成データ上でのパラメータフィッティングによって精度を評価する。
            6つの合成データに対して実験を行ったが、全てのパラメータセットで同様の結果が得られたため、QDアルゴリズムの距離が最小のパラメータセット$(\rho, \nu, s) = (5, 15, \texttt{SSW})$に対する結果のみを示す。

            図~\ref{fig:synthetic_boxplot}は、探索されたすべてのパラメータの距離$d$の最小値,最大値,四分位数を箱ひげ図で示している。
            \begin{figure}[H]
                \centering
                \includegraphics[width=\textwidth]{img/synthetic_box.png}
                \caption{パラメータ$(\rho,\nu,s)=(5,15,SSW)$の合成データと各手法の距離の箱ひげ図の比較}
                \label{fig:synthetic_boxplot}
            \end{figure}


            図~\ref{fig:synthetic_boxplot}から、最小値はどのアルゴリズムでも大きな差はないことがわかる。
            また、距離の分散は既存手法と提案手法のランダムサーチが大きい。
            これらの手法は包括的な探索を行うため、距離の分散が大きくなる。
            次にQDアルゴリズム、遺伝的アルゴリズムの順に距離の分散が小さく、全体として距離が小さい。
            QDアルゴリズムと遺伝的アルゴリズムによって、高性能な解が探索されていることがわかる。
            QDは高性能かつ多様な解が見つかっているため、遺伝的アルゴリズムより距離の分散が大きくなっていると考えられる。
            QDで見つかった多様な解については、後述するRQ3で詳しく分析する。


            図~\ref{fig:synthetic_timeline}は、遺伝的アルゴリズムとQDアルゴリズムの100世代にわたる合成データ$(\rho, \nu, s) = (5, 15, \texttt{SSW})$をターゲットとしたときの距離の変化を示す。
            波線は各世代において集団の中で最も最小の距離を示し、実線と薄い領域は集団全体の平均と第一四分位数と第三四分位数を表している。

            \begin{figure}[H]
                \centering
                \includegraphics[width=\textwidth]{img/synthetic_timeline.png}
                \caption{パラメータ$(\rho,\nu,s)=(5,15,SSW)$の合成データに対するGAとQDの探索の時間経過}
                \label{fig:synthetic_timeline}
            \end{figure}

            図\ref{fig:synthetic_timeline}より、どちらのアルゴリズムでも距離の値が世代ごとに減少し、学習が進んでいることがわかる。
            しかし、QDアルゴリズムの方が遺伝的アルゴリズムより収束が遅く、集団全体の平均の距離は大きい。
            これは、QDアルゴリズムがより多様な解を保つように探索するためだと考えられる。
            また、遺伝的アルゴリズムの結果において、時折見られる平均の距離が前の世代より大幅に増える現象は突然変異によるものである。


            表~\ref{tab:best_synthetic_distance}は、それぞれの探索手法によって、見つけた最適なパラメータセットでの実行結果を示している。
            壺モデルの実行によって得られるネットワークにはランダム性があり、同じパラメータセットで実行したとしても、生成されるネットワークは全く同じにはならない。
            そのため、壺モデルを10回実行し、その結果の平均と標準偏差を示した。

            \begin{table}[H]
                \centering
                \caption{Best fit values for synthetic data}
                \label{tab:best_synthetic_distance}
                \begin{tabular}{cccc}
                \hline
                Existing    & QD          & GA          & Random      \\ \hline
                \textbf{0.068$\pm$0.026} & 0.209$\pm$0.059 & 0.198$\pm$0.045 & 0.161$\pm$0.025   \\   \hline
                \end{tabular}
            \end{table}

            既存の手法よる探索では、ターゲットデータとして用いる合成データのパラメータも探索されるため、最も高い適合度を示している。
            既存手法が示す距離の値は、壺モデル自体のランダム性によるものである。
            提案モデルでは、ランダムサーチが最良の結果であり、遺伝的アルゴリズムとQDもほぼ同等の結果を示した。
            QDアルゴリズムや遺伝的アルゴリズムの方がランダムサーチより効率的な探索が可能だが、この実験においてはわずか4次元のパラメータ空間を探索しているため、大きな差が出なかったと考えられる。


            図~\ref{fig:radar_chart_synthetic}に評価に用いる10個の指標の結果を示す。
            QDアルゴリズムで距離が最小のパラメータセット$(\rho, \nu, s) = (5, 15, \texttt{SSW})$と距離が最大の最大のパラメータセット$(\rho, \nu, s) = (20, 7, \texttt{SSW})$の結果を示している。

            \begin{figure}[htbp]
                \centering
                \includegraphics[width=\textwidth]{img/diff_max_and_min.png}
                \caption{パラメータ$(\rho,\nu,s)=(5,15,SSW)$の合成データに対する各測定指標の既存モデルと提案モデルの比較}
                \label{fig:radar_chart_synthetic}
            \end{figure}

            最良のケースでは既存手法の方が距離が小さかったが、評価指標を見ると、ごく僅か差であることがわかる。
            また、最悪のケースでも目標データにある程度フィットしている。
            これらの結果から、提案手法は目標データの振る舞いを再現できている。


        \subsection{RQ2:実データによる精度比較}

        \begin{figure}[htbp]
            \centering
            \includegraphics[width=\textwidth]{img/boxplot.png}
            \caption{実データと各手法の距離の箱ひげ図の比較}
            \label{fig:boxplot}
        \end{figure}

        \begin{figure}[htbp]
            \centering
            \includegraphics[width=\textwidth]{img/timeline.png}
            \caption{実データに対するGAとQDの探索の時間経過}
            \label{fig:timeline}
        \end{figure}

        最も実データに適合する10個の指標の結果を図\ref{fig:radar_chart}に示す。
        \begin{figure}[htbp]
            \centering
            \includegraphics[width=\textwidth]{img/empirical_radar.png}
            \caption{実データに対する各測定指標の既存モデルと提案モデルの比較}
            \label{fig:radar_chart}
        \end{figure}

        \begin{table}[htbp]
            \centering
            \caption{Best fit values for TMN, APS and MIXI}
            \label{tab:best_distance}
            \begin{tabular}{ccccc}
            \hline
                 & Existing & QD & GA & Random \\ \hline
            TMN  & 0.837$\pm$0.025     & \textbf{0.763$\pm$0.056}       & 0.790$\pm$0.042       & 0.816$\pm$0.057   \\
            APS  & 0.603$\pm$0.037     & 0.520$\pm$0.028       & 0.534$\pm$0.033       & \textbf{0.518$\pm$0.024}   \\
            MIXI & \textbf{1.135$\pm$0.123}     & 1.178$\pm$0.081       & 1.209$\pm$0.068       & 1.213$\pm$0.069   \\ \hline
            \end{tabular}
        \end{table}

        \subsection{RQ3:実データにおける隣接可能空間の探索に用いられている戦略}

            \begin{figure}[htbp]
                \centering
                \includegraphics[width=\textwidth]{img/phenotype_map.png}
                \caption{ベクトル化したQDとGAアルゴリズムによる探索で見つけたネットワークの可視化}
                \label{fig:phenotype_map}
            \end{figure}

            \begin{landscape}
                \begin{table*}[tb]
                    \caption{Top-five best-fit parameters for each target dataset.}
                    \label{table:best-genes}
                    \begin{subtable}[h]{0.3\textwidth}
                    \centering
                    \caption{TMN}
                    \label{table:best_genes_for_twitter}
                    \begin{tabular}{rrrrrr}
                    \toprule
                    $\#$ & d & $\rho$ & $\nu$ & $r$ & $f$ \\
                    \midrule
                    \color{black} 1 & \color{black} 0.656 & {\cellcolor[HTML]{ADE0B0}} \color[HTML]{000000} \color{black} 16.79 & {\cellcolor[HTML]{9CDAA0}} \color[HTML]{000000} \color{black} 25.30 & {\cellcolor[HTML]{FEC8C8}} \color[HTML]{000000} \color{black} -0.12 & {\cellcolor[HTML]{FFF1F1}} \color[HTML]{000000} \color{black} -0.77 \\
                    \color{black} 2 & \color{black} 0.660 & {\cellcolor[HTML]{AADFAE}} \color[HTML]{000000} \color{black} 17.20 & {\cellcolor[HTML]{9CDAA0}} \color[HTML]{000000} \color{black} 26.04 & {\cellcolor[HTML]{FDB0B0}} \color[HTML]{000000} \color{black} 0.28 & {\cellcolor[HTML]{FFF8F8}} \color[HTML]{000000} \color{black} -0.89 \\
                    \color{black} 3 & \color{black} 0.661 & {\cellcolor[HTML]{9FDBA3}} \color[HTML]{000000} \color{black} 19.34 & {\cellcolor[HTML]{9CDAA0}} \color[HTML]{000000} \color{black} 29.53 & {\cellcolor[HTML]{FEC8C8}} \color[HTML]{000000} \color{black} -0.10 & {\cellcolor[HTML]{FED6D6}} \color[HTML]{000000} \color{black} -0.33 \\
                    \color{black} 4 & \color{black} 0.664 & {\cellcolor[HTML]{B2E2B5}} \color[HTML]{000000} \color{black} 15.73 & {\cellcolor[HTML]{9CDAA0}} \color[HTML]{000000} \color{black} 23.23 & {\cellcolor[HTML]{FEE9E9}} \color[HTML]{000000} \color{black} -0.65 & {\cellcolor[HTML]{FDC0C0}} \color[HTML]{000000} \color{black} 0.02 \\
                    \color{black} 5 & \color{black} 0.666 & {\cellcolor[HTML]{ADE0B0}} \color[HTML]{000000} \color{black} 16.73 & {\cellcolor[HTML]{9CDAA0}} \color[HTML]{000000} \color{black} 26.70 & {\cellcolor[HTML]{FEE3E3}} \color[HTML]{000000} \color{black} -0.54 & {\cellcolor[HTML]{FED2D2}} \color[HTML]{000000} \color{black} -0.26 \\
                    \bottomrule
                    \end{tabular}
                    \end{subtable}\hfill\begin{subtable}[h]{0.3\textwidth}
                    \centering
                    \caption{APS}
                    \label{table:best_genes_for_aps}
                    \begin{tabular}{rrrrrr}
                    \toprule
                    $\#$ & d & $\rho$ & $\nu$ & $r$ & $f$ \\
                    \midrule
                    \color{black} 1 & \color{black} 0.442 & {\cellcolor[HTML]{D2EED4}} \color[HTML]{000000} \color{black} 9.55 & {\cellcolor[HTML]{9CDAA0}} \color[HTML]{000000} \color{black} 28.59 & {\cellcolor[HTML]{FEDEDE}} \color[HTML]{000000} \color{black} -0.47 & {\cellcolor[HTML]{FFF2F2}} \color[HTML]{000000} \color{black} -0.79 \\
                    \color{black} 2 & \color{black} 0.462 & {\cellcolor[HTML]{E1F4E2}} \color[HTML]{000000} \color{black} 6.80 & {\cellcolor[HTML]{9CDAA0}} \color[HTML]{000000} \color{black} 24.66 & {\cellcolor[HTML]{FEE5E5}} \color[HTML]{000000} \color{black} -0.59 & {\cellcolor[HTML]{FDBABA}} \color[HTML]{000000} \color{black} 0.13 \\
                    \color{black} 3 & \color{black} 0.463 & {\cellcolor[HTML]{DFF3E0}} \color[HTML]{000000} \color{black} 7.14 & {\cellcolor[HTML]{9CDAA0}} \color[HTML]{000000} \color{black} 23.62 & {\cellcolor[HTML]{FED9D9}} \color[HTML]{000000} \color{black} -0.39 & {\cellcolor[HTML]{FEC7C7}} \color[HTML]{000000} \color{black} -0.09 \\
                    \color{black} 4 & \color{black} 0.464 & {\cellcolor[HTML]{DBF2DD}} \color[HTML]{000000} \color{black} 7.84 & {\cellcolor[HTML]{9CDAA0}} \color[HTML]{000000} \color{black} 26.96 & {\cellcolor[HTML]{FED1D1}} \color[HTML]{000000} \color{black} -0.24 & {\cellcolor[HTML]{FDB5B5}} \color[HTML]{000000} \color{black} 0.20 \\
                    \color{black} 5 & \color{black} 0.466 & {\cellcolor[HTML]{D2EED3}} \color[HTML]{000000} \color{black} 9.75 & {\cellcolor[HTML]{9CDAA0}} \color[HTML]{000000} \color{black} 28.77 & {\cellcolor[HTML]{FEE6E6}} \color[HTML]{000000} \color{black} -0.60 & {\cellcolor[HTML]{FEE5E5}} \color[HTML]{000000} \color{black} -0.58 \\
                    \bottomrule
                    \end{tabular}
                    \end{subtable}\hfill\begin{subtable}[h]{0.3\textwidth}
                    \centering
                    \caption{MIXI}
                    \label{table:best_genes_for_mixi}
                    \begin{tabular}{rrrrrr}
                    \toprule
                    $\#$ & d & $\rho$ & $\nu$ & $r$ & $f$ \\
                    \midrule
                    \color{black} 1 & \color{black} 0.994 & {\cellcolor[HTML]{F5FBF6}} \color[HTML]{000000} \color{black} 2.90 & {\cellcolor[HTML]{FAFDFA}} \color[HTML]{000000} \color{black} 2.05 & {\cellcolor[HTML]{FFFAFA}} \color[HTML]{000000} \color{black} -0.91 & {\cellcolor[HTML]{FDADAD}} \color[HTML]{000000} \color{black} 0.34 \\
                    \color{black} 2 & \color{black} 1.024 & {\cellcolor[HTML]{F7FCF8}} \color[HTML]{000000} \color{black} 2.56 & {\cellcolor[HTML]{F6FCF7}} \color[HTML]{000000} \color{black} 2.67 & {\cellcolor[HTML]{FEDDDD}} \color[HTML]{000000} \color{black} -0.44 & {\cellcolor[HTML]{FEC2C2}} \color[HTML]{000000} \color{black} -0.01 \\
                    \color{black} 3 & \color{black} 1.030 & {\cellcolor[HTML]{F8FCF8}} \color[HTML]{000000} \color{black} 2.42 & {\cellcolor[HTML]{F5FBF6}} \color[HTML]{000000} \color{black} 2.87 & {\cellcolor[HTML]{FFEFEF}} \color[HTML]{000000} \color{black} -0.74 & {\cellcolor[HTML]{FD9B9B}} \color[HTML]{000000} \color{black} 0.62 \\
                    \color{black} 4 & \color{black} 1.033 & {\cellcolor[HTML]{F9FDF9}} \color[HTML]{000000} \color{black} 2.15 & {\cellcolor[HTML]{FAFDFA}} \color[HTML]{000000} \color{black} 2.01 & {\cellcolor[HTML]{FFFBFB}} \color[HTML]{000000} \color{black} -0.92 & {\cellcolor[HTML]{FEC7C7}} \color[HTML]{000000} \color{black} -0.08 \\
                    \color{black} 5 & \color{black} 1.034 & {\cellcolor[HTML]{F8FCF8}} \color[HTML]{000000} \color{black} 2.46 & {\cellcolor[HTML]{F8FCF8}} \color[HTML]{000000} \color{black} 2.40 & {\cellcolor[HTML]{FFFBFB}} \color[HTML]{000000} \color{black} -0.93 & {\cellcolor[HTML]{FFF4F4}} \color[HTML]{000000} \color{black} -0.82 \\
                    \bottomrule
                    \end{tabular}
                \end{subtable}\hfill\end{table*}
            \end{landscape}





\chapter{結論}

% レポートや論文の書き方、日本語の\LaTeX の使い方に関しては、Web 上の情報や
% 参考書など~\cite{Bibunsho,ScienceResearchWriting}を参照のこと。
% また、参考文献、図、表の入れ方を含む、文章のスタイルについては、
% ACM, IEEE, 情報処理学会, 電子情報通信学会などの学会が出版している
% ジャーナルや国際会議の論文のスタイルを参考にするとよい。

\chapter*{謝辞}
\addcontentsline{toc}{chapter}{\numberline{}謝辞}
    本研究の遂行にあたり、研究の着想から論文の完成に至るまで、熱心なご指導と多大なご助言を賜りました岡瑞起教授に深く感謝申し上げます。
    また、毎週のゼミや研究室での議論を通じて、様々なご助言をいただいた研究室の皆様に心よりお礼申し上げます。
    特に、昨年卒業された須田幹大さんには、研究の方向性や壺モデルの実装に関する多くのご助言をいただきました。
    須田さんの経験と知識から多くのことを学び、研究を進める上で大変お世話になりました。
    また、岡部純弥さんには実験に関するサポートとご助言をいただきました。
    さらに、株式会社MIXIの皆様には、データセットの提供していただきました。
    このように、多くの方々のご協力に恵まれ、本研究を遂行することができました。
    心より感謝申し上げます。


\newpage

% \addcontentsline{toc}{chapter}{\numberline{}参考文献}
% \renewcommand{\bibname}{参考文献}

%% 参考文献に jbibtex を使う場合
% \bibliographystyle{junsrt}
% \bibliography{ref}


\bibliographystyle{junsrt}
\bibliography{ref}

% [compile] jbibtex sample; platex sample; platex sample;


\end{document}
